<div class="property-panel" data-testid="property-panel">
  @if (selectedElement(); as element) {
    <div class="panel-content">
      <h3 class="panel-title">Element Properties</h3>
      
      <section class="property-section">
        <header class="section-header">General</header>
        <div class="section-body">
          <div class="property-field">
            <label class="property-label">Type</label>
            <input class="property-input" [value]="element.type" disabled />
          </div>

          <div class="property-field">
            <label class="property-label">Position (mm)</label>
            <div class="property-row">
              <input 
                type="number" 
                class="property-input" 
                [value]="element.x" 
                (input)="updatePosition(+$any($event.target).value, element.y)"
                placeholder="X"
                data-testid="input-x" />
              <input 
                type="number" 
                class="property-input" 
                [value]="element.y" 
                (input)="updatePosition(element.x, +$any($event.target).value)"
                placeholder="Y"
                data-testid="input-y" />
            </div>
          </div>

          <div class="property-field">
            <label class="property-label">Size (mm)</label>
            <div class="property-row">
              <input 
                type="number" 
                class="property-input" 
                [value]="element.width" 
                (input)="updateSize(+$any($event.target).value, element.height)"
                placeholder="Width"
                data-testid="input-width" />
              <input 
                type="number" 
                class="property-input" 
                [value]="element.height" 
                (input)="updateSize(element.width, +$any($event.target).value)"
                placeholder="Height"
                data-testid="input-height" />
            </div>
          </div>

          <div class="property-field">
            <label class="property-label">ID</label>
            <input 
              type="text" 
              class="property-input" 
              maxlength="20"
              [value]="getElementId(element)"
              (input)="updateElementId($any($event.target).value)"
              placeholder="element-id"
              data-testid="input-element-id" />
          </div>

          <div class="property-field">
            <label class="property-label">Role</label>
            <select 
              class="property-input"
              [value]="getElementRole(element)"
              (change)="updateElementRole($any($event.target).value)"
              data-testid="input-element-role">
              <option value="">None</option>
              <option value="report-header">Header</option>
              <option value="report-body">Body</option>
              <option value="report-footer">Footer</option>
            </select>
          </div>
        </div>
      </section>

      @if (isTable(element)) {
        <section class="property-section">
          <header class="section-header">Table</header>
          <div class="section-body">
            <div class="property-grid">
              <div class="property-field">
                <label class="property-label">Rows</label>
                <input 
                  type="number" 
                  min="1"
                  step="1"
                  class="property-input"
                  [value]="tableProperty(element, 'rows')"
                  (input)="updateTableProperty('rows', +$any($event.target).value)"
                  data-testid="input-table-rows" />
              </div>
              <div class="property-field">
                <label class="property-label">Columns</label>
                <input 
                  type="number" 
                  min="1"
                  step="1"
                  class="property-input"
                  [value]="tableProperty(element, 'cols')"
                  (input)="updateTableProperty('cols', +$any($event.target).value)"
                  data-testid="input-table-cols" />
              </div>
            </div>


          </div>
        </section>
      }

      @if (hasSelectedCell()) {
        @let padding = getSelectedCellPadding();
        <section class="property-section">
          <header class="section-header">Cell</header>
          <div class="section-body">
            <div class="property-grid">
              <div class="property-field">
                <label class="property-label">Pad Top (mm)</label>
                <input type="number" min="0" step="1" class="property-input"
                       [value]="padding?.top"
                       (input)="updateSelectedCellPadding('top', +$any($event.target).value)" />
              </div>
              <div class="property-field">
                <label class="property-label">Pad Right (mm)</label>
                <input type="number" min="0" step="1" class="property-input"
                       [value]="padding?.right"
                       (input)="updateSelectedCellPadding('right', +$any($event.target).value)" />
              </div>
              <div class="property-field">
                <label class="property-label">Pad Bottom (mm)</label>
                <input type="number" min="0" step="1" class="property-input"
                       [value]="padding?.bottom"
                       (input)="updateSelectedCellPadding('bottom', +$any($event.target).value)" />
              </div>
              <div class="property-field">
                <label class="property-label">Pad Left (mm)</label>
                <input type="number" min="0" step="1" class="property-input"
                       [value]="padding?.left"
                       (input)="updateSelectedCellPadding('left', +$any($event.target).value)" />
              </div>
            </div>

            <div class="property-field">
              <label class="property-label">Horizontal Align</label>
              <div class="align-buttons-row">
                <button type="button" class="align-btn" [class.active]="getSelectedCellHAlign()==='left'" (click)="updateSelectedCellAlignment('h','left')"><span class="ico-align_horizontal_left"></span></button>
                <button type="button" class="align-btn" [class.active]="getSelectedCellHAlign()==='center'" (click)="updateSelectedCellAlignment('h','center')"><span class="ico-align_horizontal_center"></span></button>
                <button type="button" class="align-btn" [class.active]="getSelectedCellHAlign()==='right'" (click)="updateSelectedCellAlignment('h','right')"><span class="ico-align_horizontal_right"></span></button>
              </div>
            </div>
            <div class="property-field">
              <label class="property-label">Vertical Align</label>
              <div class="align-buttons-row">
                <button type="button" class="align-btn" [class.active]="getSelectedCellVAlign()==='top'" (click)="updateSelectedCellAlignment('v','top')"><span class="ico-align_vertical_top"></span></button>
                <button type="button" class="align-btn" [class.active]="getSelectedCellVAlign()==='middle'" (click)="updateSelectedCellAlignment('v','middle')"><span class="ico-align_vertical_center"></span></button>
                <button type="button" class="align-btn" [class.active]="getSelectedCellVAlign()==='bottom'" (click)="updateSelectedCellAlignment('v','bottom')"><span class="ico-align_vertical_bottom"></span></button>
              </div>
            </div>

            <div class="property-subsection">
              <header class="subsection-header">Cell Border</header>
              <div class="property-grid">
                <div class="property-field">
                  <label class="property-label">Width (px)</label>
                  <input type="number" min="0" step="1" class="property-input"
                         [value]="getSelectedCellBorderWidth()"
                         (input)="updateSelectedCellBorder('width', $any($event.target).value)" />
                </div>
                <div class="property-field">
                  <label class="property-label">Style</label>
                  <select class="property-input"
                          [value]="getSelectedCellBorderStyle()"
                          (change)="updateSelectedCellBorder('style', $any($event.target).value)">
                    <option value="none">none</option>
                    <option value="solid">solid</option>
                    <option value="dashed">dashed</option>
                    <option value="dotted">dotted</option>
                    <option value="double">double</option>
                  </select>
                </div>
                <div class="property-field">
                  <label class="property-label">Color</label>
                  <input type="color" class="property-input"
                         [value]="getSelectedCellBorderColor()"
                         (input)="updateSelectedCellBorder('color', $any($event.target).value)" />
                </div>
              </div>
            </div>

            <div class="property-subsection">
              <header class="subsection-header">Font</header>
              <div class="property-grid">
                <div class="property-field">
                  <label class="property-label">Font Weight</label>
                  <select class="property-input"
                          [value]="getSelectedCellFontWeight()"
                          (change)="updateSelectedCellFont('weight', $any($event.target).value)">
                    <option value="normal">normal</option>
                    <option value="bold">bold</option>
                    <option value="bolder">bolder</option>
                    <option value="lighter">lighter</option>
                  </select>
                </div>
                <div class="property-field">
                  <label class="property-label">Font Style</label>
                  <select class="property-input"
                          [value]="getSelectedCellFontStyle()"
                          (change)="updateSelectedCellFont('style', $any($event.target).value)">
                    <option value="normal">normal</option>
                    <option value="italic">italic</option>
                    <option value="oblique">oblique</option>
                  </select>
                </div>
                <div class="property-field">
                  <label class="property-label">Decoration</label>
                  <select class="property-input"
                          [value]="getSelectedCellTextDecoration()"
                          (change)="updateSelectedCellFont('decoration', $any($event.target).value)">
                    <option value="none">None</option>
                    <option value="underline">Underline</option>
                    <option value="overline">Overline</option>
                    <option value="line-through">StrikeThrough</option>
                  </select>
                </div>
                <div class="property-field">
                  <label class="property-label">Font Size (pt)</label>
                  <input type="number" min="1" step="1" class="property-input"
                         [value]="getSelectedCellFontSize()"
                         (input)="updateSelectedCellFont('size', $any($event.target).value)" />
                </div>
                <div class="property-field">
                  <label class="property-label">Line Height</label>
                  <input type="number" min="0.5" step="0.1" class="property-input"
                         [value]="getSelectedCellLineHeight()"
                         (input)="updateSelectedCellFont('lineHeight', $any($event.target).value)" />
                </div>
                <div class="property-field" style="grid-column: span 2;">
                  <label class="property-label">Font Family</label>
                  <select class="property-input"
                          [value]="getSelectedCellFontFamily()"
                          (change)="updateSelectedCellFont('family', $any($event.target).value)">
                    <option value="serif">serif</option>
                    <option value="sans-serif">sans-serif</option>
                    <option value="monospace">monospace</option>
                    <option value="cursive">cursive</option>
                    <option value="Arial, Helvetica, sans-serif">Arial</option>
                    <option value="Verdana, Geneva, sans-serif">Verdana</option>
                    <option value="Tahoma, Geneva, sans-serif">Tahoma</option>
                    <option value="'Trebuchet MS', sans-serif">Trebuchet MS</option>
                    <option value="'Segoe UI', Tahoma, sans-serif">Segoe UI</option>
                    <option value="Calibri, sans-serif">Calibri</option>
                    <option value="'Times New Roman', Times, serif">Times New Roman</option>
                    <option value="Georgia, serif">Georgia</option>
                    <option value="'Courier New', Courier, monospace">Courier New</option>
                    <option value="Consolas, monospace">Consolas</option>
                    <option value="Symbol">Symbol</option>
                    <option value="Webdings">Webdings</option>
                    <option value="Wingdings">Wingdings</option>
                    <option value="Roboto, sans-serif">Roboto</option>
                    <option value="'Open Sans', sans-serif">Open Sans</option>
                    <option value="Lato, sans-serif">Lato</option>
                    <option value="Montserrat, sans-serif">Montserrat</option>
                    <option value="Poppins, sans-serif">Poppins</option>
                    <option value="Raleway, sans-serif">Raleway</option>
                  </select>
                </div>
              </div>
            </div>
          </div>
        </section>
      }

      <button 
        class="delete-button" 
        (click)="deleteElement()"
        data-testid="button-delete">
        Delete Element
      </button>
    </div>
  } @else {
    <div class="empty-state">
      <p>No element selected</p>
      <p class="hint">Click an element on the canvas to edit its properties</p>
    </div>
  }
</div>
