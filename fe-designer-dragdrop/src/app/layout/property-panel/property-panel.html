<div class="property-panel" data-testid="property-panel">
  @if (selectedElement(); as element) {
    <div class="panel-content">
      <h3 class="panel-title">Element Properties</h3>
      
      <section class="property-section">
        <header class="section-header">General</header>
        <div class="section-body">
          <div class="property-field">
            <label class="property-label">Type</label>
            <input class="property-input" [value]="element.type" disabled />
          </div>

          <div class="property-field">
            <label class="property-label">Position (mm)</label>
            <div class="property-row">
              <input 
                type="number" 
                class="property-input" 
                [value]="element.x" 
                (input)="updatePosition(+$any($event.target).value, element.y)"
                placeholder="X"
                data-testid="input-x" />
              <input 
                type="number" 
                class="property-input" 
                [value]="element.y" 
                (input)="updatePosition(element.x, +$any($event.target).value)"
                placeholder="Y"
                data-testid="input-y" />
            </div>
          </div>

          <div class="property-field">
            <label class="property-label">Size (mm)</label>
            <div class="property-row">
              <input 
                type="number" 
                class="property-input" 
                [value]="element.width" 
                (input)="updateSize(+$any($event.target).value, element.height)"
                placeholder="Width"
                data-testid="input-width" />
              <input 
                type="number" 
                class="property-input" 
                [value]="element.height" 
                (input)="updateSize(element.width, +$any($event.target).value)"
                placeholder="Height"
                data-testid="input-height" />
            </div>
          </div>

          <div class="property-field">
            <label class="property-label">Content</label>
            <textarea 
              class="property-textarea" 
              [value]="element.content"
              (input)="updateContent($any($event.target).value)"
              data-testid="input-content"></textarea>
          </div>
        </div>
      </section>

      @if (isTable(element)) {
        <section class="property-section">
          <header class="section-header">Table</header>
          <div class="section-body">
            <div class="property-grid">
              <div class="property-field">
                <label class="property-label">Rows</label>
                <input 
                  type="number" 
                  min="1"
                  step="1"
                  class="property-input"
                  [value]="tableProperty(element, 'rows')"
                  (input)="updateTableProperty('rows', +$any($event.target).value)"
                  data-testid="input-table-rows" />
              </div>
              <div class="property-field">
                <label class="property-label">Columns</label>
                <input 
                  type="number" 
                  min="1"
                  step="1"
                  class="property-input"
                  [value]="tableProperty(element, 'cols')"
                  (input)="updateTableProperty('cols', +$any($event.target).value)"
                  data-testid="input-table-cols" />
              </div>
            </div>


          </div>
        </section>
      }

      @if (hasSelectedCell()) {
        @let padding = getSelectedCellPadding();
        <section class="property-section">
          <header class="section-header">Cell</header>
          <div class="section-body">
            <div class="property-grid">
              <div class="property-field">
                <label class="property-label">Pad Top (mm)</label>
                <input type="number" min="0" step="1" class="property-input"
                       [value]="padding?.top"
                       (input)="updateSelectedCellPadding('top', +$any($event.target).value)" />
              </div>
              <div class="property-field">
                <label class="property-label">Pad Right (mm)</label>
                <input type="number" min="0" step="1" class="property-input"
                       [value]="padding?.right"
                       (input)="updateSelectedCellPadding('right', +$any($event.target).value)" />
              </div>
              <div class="property-field">
                <label class="property-label">Pad Bottom (mm)</label>
                <input type="number" min="0" step="1" class="property-input"
                       [value]="padding?.bottom"
                       (input)="updateSelectedCellPadding('bottom', +$any($event.target).value)" />
              </div>
              <div class="property-field">
                <label class="property-label">Pad Left (mm)</label>
                <input type="number" min="0" step="1" class="property-input"
                       [value]="padding?.left"
                       (input)="updateSelectedCellPadding('left', +$any($event.target).value)" />
              </div>
            </div>

            <div class="property-field">
              <label class="property-label">Horizontal Align</label>
              <div class="align-buttons-row">
                <button type="button" class="align-btn" [class.active]="getSelectedCellHAlign()==='left'" (click)="updateSelectedCellAlignment('h','left')"><span class="ico-align_horizontal_left"></span></button>
                <button type="button" class="align-btn" [class.active]="getSelectedCellHAlign()==='center'" (click)="updateSelectedCellAlignment('h','center')"><span class="ico-align_horizontal_center"></span></button>
                <button type="button" class="align-btn" [class.active]="getSelectedCellHAlign()==='right'" (click)="updateSelectedCellAlignment('h','right')"><span class="ico-align_horizontal_right"></span></button>
              </div>
            </div>
            <div class="property-field">
              <label class="property-label">Vertical Align</label>
              <div class="align-buttons-row">
                <button type="button" class="align-btn" [class.active]="getSelectedCellVAlign()==='top'" (click)="updateSelectedCellAlignment('v','top')"><span class="ico-align_vertical_top"></span></button>
                <button type="button" class="align-btn" [class.active]="getSelectedCellVAlign()==='middle'" (click)="updateSelectedCellAlignment('v','middle')"><span class="ico-align_vertical_center"></span></button>
                <button type="button" class="align-btn" [class.active]="getSelectedCellVAlign()==='bottom'" (click)="updateSelectedCellAlignment('v','bottom')"><span class="ico-align_vertical_bottom"></span></button>
              </div>
            </div>

            <div class="property-subsection">
              <header class="subsection-header">Cell Border</header>
              <div class="property-grid">
                <div class="property-field">
                  <label class="property-label">Width (px)</label>
                  <input type="number" min="0" step="1" class="property-input"
                         [value]="getSelectedCellBorderWidth()"
                         (input)="updateSelectedCellBorder('width', $any($event.target).value)" />
                </div>
                <div class="property-field">
                  <label class="property-label">Style</label>
                  <select class="property-input"
                          [value]="getSelectedCellBorderStyle()"
                          (change)="updateSelectedCellBorder('style', $any($event.target).value)">
                    <option value="none">none</option>
                    <option value="solid">solid</option>
                    <option value="dashed">dashed</option>
                    <option value="dotted">dotted</option>
                    <option value="double">double</option>
                  </select>
                </div>
                <div class="property-field">
                  <label class="property-label">Color</label>
                  <input type="color" class="property-input"
                         [value]="getSelectedCellBorderColor()"
                         (input)="updateSelectedCellBorder('color', $any($event.target).value)" />
                </div>
              </div>
            </div>
          </div>
        </section>
      }

      <button 
        class="delete-button" 
        (click)="deleteElement()"
        data-testid="button-delete">
        Delete Element
      </button>
    </div>
  } @else {
    <div class="empty-state">
      <p>No element selected</p>
      <p class="hint">Click an element on the canvas to edit its properties</p>
    </div>
  }
</div>
